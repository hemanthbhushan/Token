// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.11;

import "./TokenContract.sol";
 

 contract FactoryContract{
     address public owner;

     struct TokenDetails{
        string name;
        string symbol;
        uint8 decimals;
        uint256 initialSupply;
    }
   mapping(address=>TokenDetails) public registerToken;

    event tokenRegistered(
        address indexed tokenAddress,
        TokenDetails indexed tokenDetails
    );

    event tokenUnregistered(
        address indexed tokenAddress,
        string indexed name,
        string indexed symbol
    );


      modifier onlyAdmin() {
        require(msg.sender == owner, "onlyAdmin");
        _;
    }

    
    constructor(){
         owner = msg.sender;
    }


        function CreateERC20Token(
        string calldata _name,
        string calldata _symbol,
        uint8 _decimals,
        uint256 _initialSupply
    ) external onlyAdmin returns (TokenContract tokenAddress) {

         tokenAddress = new TokenContract(
            _name,
            _symbol
        );
        registerTokens(TokenDetails({name:_name,symbol:_symbol,decimals:_decimals,initialSupply: _initialSupply}),address(tokenAddress));

        
        return tokenAddress;
    }


     
    function registerTokens(TokenDetails memory tokenDetails,address tokenAddress) internal  {

        require(tokenAddress!= address(0) ,"invalid Token address");

        registerToken[tokenAddress] = TokenDetails({
            name:tokenDetails.name,
            symbol:tokenDetails.symbol,
            decimals:tokenDetails.decimals,
            initialSupply:tokenDetails.initialSupply
        }); 


        emit tokenRegistered(tokenAddress,tokenDetails);
    }

     function unregisterTokens(address tokenAddress) external onlyAdmin  {

        require(tokenAddress!= address(0) ,"invalid Token address");
        // require(registerToken[tokenAddress]==,"");
        

         TokenDetails memory details = registerToken[tokenAddress];

         delete registerToken[tokenAddress]; 


        emit tokenUnregistered(tokenAddress,details.name,details.symbol);

    }


 }
